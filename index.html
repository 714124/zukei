<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>„Åü„ÅÆ„Åó„ÅÑÂõ≥ÂΩ¢„ÇØ„Ç§„Ç∫</title>
    <!-- React & Tailwind CSS -->
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @keyframes float {
            0%, 100% { transform: translateY(0) rotate(0); }
            50% { transform: translateY(-20px) rotate(10deg); }
        }
        @keyframes float-delayed {
            0%, 100% { transform: translateY(0) rotate(0); }
            50% { transform: translateY(-20px) rotate(-10deg); }
        }
        .animate-float { animation: float 4s infinite ease-in-out; }
        .animate-float-delayed { animation: float-delayed 5s infinite ease-in-out; animation-delay: 1s; }
        
        @keyframes yellow-pulse {
            0%, 100% { transform: scale(1); filter: drop-shadow(0 0 0px #fbbf24); }
            50% { transform: scale(1.1); filter: drop-shadow(0 0 30px #fbbf24); }
        }
        .animate-yellow-pulse {
            animation: yellow-pulse 2s infinite ease-in-out;
        }
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-15px); }
            75% { transform: translateX(15px); }
        }
        .animate-shake {
            animation: shake 0.15s ease-in-out 0s 2;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // Lucide„Ç¢„Ç§„Ç≥„É≥„ÇíReact„Ç≥„É≥„Éù„Éº„Éç„É≥„Éà„Å®„Åó„Å¶Ê®°ÂÄ£„Åô„ÇãÁ∞°Êòì„Ç≥„É≥„Éù„Éº„Éç„É≥„Éà
        const Icon = ({ name, size = 24, className = "" }) => {
            return <i data-lucide={name} style={{ width: size, height: size }} className={className}></i>;
        };

        const App = () => {
            const [currentStep, setCurrentStep] = useState('start'); 
            const [quizSet, setQuizSet] = useState([]);
            const [questionIndex, setQuestionIndex] = useState(0);
            const [score, setScore] = useState(0);
            const [feedback, setFeedback] = useState(null); 
            const [isLocked, setIsLocked] = useState(false);

            useEffect(() => {
                if (window.lucide) {
                    window.lucide.createIcons();
                }
            }, [currentStep, feedback]);

            const allQuestions = [
                { question: '„Åì„ÅÆ ÂΩ¢„ÅÆ ÂêçÂâç„ÅØ ‰Ωï„Åã„Å™Ôºü', visual: { type: 'shape', value: 'circle' }, options: ['„Åæ„Çã', '„Åï„Çì„Åã„Åè', '„Åó„Åã„Åè', '„Åä„Åª„Åó„Åï„Åæ'], answer: '„Åæ„Çã', hint: '„Åì„Çç„Åì„Çç „Åì„Çç„Åå„Çã„Çà' },
                { question: '„Äå„Åó„Åã„Åè„Äç„ÅØ „Å©„Çå„Åã„Å™Ôºü', visual: { type: 'text', value: '„Å©„Çå„Åã„Å™Ôºü' }, options: ['‚ñ≥', '„Äá', '‚ñ°', '‚òÜ'], answer: '‚ñ°', hint: '„Ç´„Éâ„Åå 4„Å§ „ÅÇ„Çã„Çà' },
                { question: '„Åä„Å´„Åé„Çä„Å® Âêå„Åò ÂΩ¢„ÅØ „Å©„Çå„Åã„Å™Ôºü', visual: { type: 'emoji', value: 'üçô' }, options: ['„Åæ„Çã', '„Åï„Çì„Åã„Åè', '„Åó„Åã„Åè', '„Åä„ÅØ„Å™'], answer: '„Åï„Çì„Åã„Åè', hint: '„Ç´„Éâ„Åå 3„Å§ „ÅÇ„Çã„Çà' },
                { question: '„Åï„Çì„Åã„Åè„Çí 2„Å§ „ÅÇ„Çè„Åõ„Çã„Å®Ôºü', visual: { type: 'composition', value: '‚ñ≤‚ñ≤' }, options: ['„Åæ„Çã', '„Åó„Åã„Åè', '„Åä„Åª„Åó„Åï„Åæ', '„Å™„Åø„Å™„Åø'], answer: '„Åó„Åã„Åè', hint: '„Çµ„É≥„Éâ„Ç§„ÉÉ„ÉÅ„Çí 2„Å§„Åè„Å£„Å§„Åë„Çã„Å®‚Ä¶Ôºü' },
                { question: '„Éâ„Éº„Éä„ÉÑ„Å® Âêå„Åò ÂΩ¢„ÅØ „Å©„ÇåÔºü', visual: { type: 'emoji', value: 'üç©' }, options: ['„Äá', '‚ñ≥', '‚ñ°', '‚òÜ'], answer: '„Äá', hint: '„ÅÇ„Å™„Åå „ÅÇ„ÅÑ„Åü „Åæ„Çã„Å†„Çà' },
                { question: '„Äå„Åæ„Çã„Äç„ÅØ „Å©„Çå„Åã„Å™Ôºü', visual: { type: 'text', value: '„Åï„Åå„Åó„Å¶„Åø„Å¶„Å≠' }, options: ['‚ñ°', '‚ñ≥', '„Äá', '‚òÜ'], answer: '„Äá', hint: '„Ç´„Éâ„Åå„Å™„ÅÑ „Å§„Çã„Å§„Çã„ÅÆÂΩ¢„Å†„Çà' },
                { question: '„Äå„Åï„Çì„Åã„Åè„Äç„Çí „Åï„Åå„Åù„ÅÜÔºÅ', visual: { type: 'text', value: '„Å©„Çå„Åã„Å™Ôºü' }, options: ['„Äá', '‚ñ°', '‚òÜ', '‚ñ≥'], answer: '‚ñ≥', hint: '„Ç´„Éâ„Åå 3„Å§ „ÅÇ„Çã„Çà' },
                { question: '„ÉÜ„É¨„Éì„Å® Âêå„Åò ÂΩ¢„ÅØ „Å©„ÇåÔºü', visual: { type: 'emoji', value: 'üì∫' }, options: ['„Åó„Åã„Åè', '„Åæ„Çã', '„Åï„Çì„Åã„Åè', '„Åä„ÅØ„Å™'], answer: '„Åó„Åã„Åè', hint: '„ÅæÂõõËßí„ÅÑ „Åã„Åü„Å°„Å†„Å≠' },
                { question: '„Äå„ÅØ„Çì„Å∂„Çì„ÅÆ „Åæ„Çã„Äç„ÅØ „Å©„Çå„Åã„Å™Ôºü', visual: { type: 'text', value: '„Çπ„Ç§„Ç´„ÅÆ „Åã„Åü„Å°' }, options: ['„Äá', 'D', '‚ñ≥', '‚ñ°'], answer: 'D', hint: '„Åæ„Çã„Çí „Åæ„Çì‰∏≠„Åß „Åç„Å£„Åü„Çà' },
                { question: '„Åó„Åã„Åè„Çí 2„Å§ „Å§„Å™„Åí„Çã„Å®Ôºü', visual: { type: 'composition', value: '‚ñ†‚ñ†' }, options: ['„Å™„Åå„ÅÑ „Åó„Åã„Åè', '„Åæ„Çã', '„Åï„Çì„Åã„Åè', '„Å∞„Å§'], answer: '„Å™„Åå„ÅÑ „Åó„Åã„Åè', hint: '„Éê„Çπ„ÇÑ „Åß„Çì„Åó„ÇÉ„ÅÆ „Åã„Åü„Å°„Å†„Å≠' }
            ];

            const startNewQuiz = () => {
                playSound('click');
                const shuffled = [...allQuestions].sort(() => Math.random() - 0.5);
                setQuizSet(shuffled.slice(0, 5));
                setQuestionIndex(0);
                setScore(0);
                setFeedback(null);
                setIsLocked(false);
                setCurrentStep('quiz');
            };

            const playSound = (type) => {
                try {
                    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
                    const oscillator = audioCtx.createOscillator();
                    const gainNode = audioCtx.createGain();
                    oscillator.connect(gainNode);
                    gainNode.connect(audioCtx.destination);

                    if (type === 'correct') {
                        oscillator.frequency.setValueAtTime(523.25, audioCtx.currentTime); 
                        oscillator.frequency.exponentialRampToValueAtTime(880, audioCtx.currentTime + 0.1); 
                        gainNode.gain.setValueAtTime(0.5, audioCtx.currentTime);
                    } else if (type === 'incorrect') {
                        oscillator.type = 'sawtooth';
                        oscillator.frequency.setValueAtTime(200, audioCtx.currentTime);
                        gainNode.gain.setValueAtTime(0.3, audioCtx.currentTime);
                    } else {
                        oscillator.frequency.setValueAtTime(440, audioCtx.currentTime);
                        gainNode.gain.setValueAtTime(0.1, audioCtx.currentTime);
                    }
                    oscillator.start();
                    oscillator.stop(audioCtx.currentTime + (type === 'correct' ? 0.5 : 0.3));
                } catch (e) {}
            };

            const handleAnswer = (option) => {
                if (isLocked) return;
                setIsLocked(true);
                const isCorrect = option === quizSet[questionIndex].answer;
                if (isCorrect) {
                    setScore(s => s + 1);
                    setFeedback('correct');
                    playSound('correct');
                } else {
                    setFeedback('incorrect');
                    playSound('incorrect');
                }
                setTimeout(() => {
                    setFeedback(null);
                    if (questionIndex < quizSet.length - 1) {
                        setQuestionIndex(i => i + 1);
                        setIsLocked(false);
                    } else {
                        setCurrentStep('result');
                    }
                }, 1500);
            };

            return (
                <div className="min-h-screen bg-sky-200 flex flex-col items-center justify-center p-4 font-sans text-gray-800 relative overflow-hidden">
                    <div className="absolute top-[10%] left-[5%] text-6xl animate-float">üòäüü°</div>
                    <div className="absolute top-[20%] right-[10%] text-6xl animate-float-delayed">üòäüü•</div>
                    <div className="absolute bottom-[15%] left-[10%] text-6xl animate-float">üòäüî∫</div>
                    <div className="absolute bottom-[20%] right-[5%] text-6xl animate-float-delayed">‚ú®</div>

                    <div className="w-full max-w-2xl bg-yellow-100 rounded-[3rem] shadow-2xl overflow-hidden border-[12px] border-white relative z-10">
                        {currentStep === 'start' && (
                            <div className="p-10 text-center space-y-10">
                                <h1 className="text-5xl md:text-6xl font-black text-pink-500 drop-shadow-sm">„Åü„ÅÆ„Åó„ÅÑÂõ≥ÂΩ¢„ÇØ„Ç§„Ç∫</h1>
                                <p className="text-3xl font-bold text-sky-500">„Åæ„Çã„Éª„Åï„Çì„Åã„Åè„Éª„Åó„Åã„Åè</p>
                                <div className="bg-white rounded-full p-12 shadow-inner border-4 border-dashed border-sky-300 inline-block">
                                    <div className="text-9xl animate-pulse">üòäüü°</div>
                                </div>
                                <button onClick={startNewQuiz} className="bg-orange-400 hover:bg-orange-500 text-white text-4xl font-black py-8 px-16 rounded-full shadow-[0_10px_0_rgb(194,120,0)] transform active:translate-y-2 active:shadow-none transition-all">„ÅØ„Åò„ÇÅ„ÇãÔºÅ</button>
                            </div>
                        )}

                        {currentStep === 'quiz' && (
                            <div className="p-6 md:p-8 relative">
                                <div className="flex justify-between items-center mb-4 px-4 font-bold text-blue-400">
                                    <span>{questionIndex + 1} / 5</span>
                                    <div className="flex gap-2">
                                        {[...Array(5)].map((_, i) => (
                                            <div key={i} className={`w-4 h-4 rounded-full ${i <= questionIndex ? 'bg-orange-400' : 'bg-white'}`} />
                                        ))}
                                    </div>
                                </div>
                                <div className="bg-white rounded-[3rem] p-8 shadow-md mb-8 border-4 border-sky-100 text-center">
                                    <h2 className="text-3xl md:text-4xl font-bold leading-tight text-blue-700">{quizSet[questionIndex].question}</h2>
                                </div>
                                <div className="flex justify-center mb-10 h-48 items-center bg-white bg-opacity-50 rounded-3xl border-4 border-white">
                                    {quizSet[questionIndex].visual.type === 'shape' && <div className="w-36 h-36 rounded-full bg-yellow-400 border-8 border-white shadow-lg flex items-center justify-center text-5xl animate-pulse">üòä</div>}
                                    {quizSet[questionIndex].visual.type === 'emoji' && <div className="text-[10rem] animate-bounce">{quizSet[questionIndex].visual.value}</div>}
                                    {quizSet[questionIndex].visual.type === 'composition' && (
                                        <div className="flex gap-4 items-center text-8xl font-black">
                                            <span className={quizSet[questionIndex].visual.value === '‚ñ≤‚ñ≤' ? 'text-green-500' : 'text-blue-500'}>{quizSet[questionIndex].visual.value[0]}</span>
                                            <span className="text-4xl text-gray-400">+</span>
                                            <span className={quizSet[questionIndex].visual.value === '‚ñ≤‚ñ≤' ? 'text-green-500' : 'text-blue-500'}>{quizSet[questionIndex].visual.value[1]}</span>
                                        </div>
                                    )}
                                    {quizSet[questionIndex].visual.type === 'text' && <div className="text-6xl font-black text-pink-400 animate-pulse">{quizSet[questionIndex].visual.value}</div>}
                                </div>
                                <div className="grid grid-cols-2 gap-6">
                                    {quizSet[questionIndex].options.map((opt, idx) => (
                                        <button key={idx} onClick={() => handleAnswer(opt)} disabled={isLocked} className={`py-8 px-4 rounded-[2rem] text-3xl font-black shadow-[0_8px_0_rgba(0,0,0,0.1)] transform active:translate-y-1 active:shadow-none transition-all border-4 border-white ${idx===0?'bg-green-400':idx===1?'bg-orange-400':idx===2?'bg-purple-400':'bg-sky-400'} text-white ${isLocked?'opacity-50':'hover:brightness-105'}`}>{opt}</button>
                                    ))}
                                </div>
                                {feedback && (
                                    <div className="absolute inset-0 flex items-center justify-center bg-white bg-opacity-90 z-20 rounded-[2.5rem]">
                                        <div className={`text-center ${feedback === 'correct' ? 'animate-bounce' : 'animate-shake'}`}>
                                            <div className="text-[12rem]">{feedback === 'correct' ? '‚≠ï' : '‚ùå'}</div>
                                            <p className={`text-5xl font-black ${feedback === 'correct' ? 'text-pink-500' : 'text-blue-500'}`}>{feedback === 'correct' ? '„Åõ„ÅÑ„Åã„ÅÑÔºÅÔºÅ' : '„Åä„Åó„ÅÑÔºÅ'}</p>
                                        </div>
                                    </div>
                                )}
                            </div>
                        )}

                        {currentStep === 'result' && (
                            <div className="p-12 text-center space-y-10 bg-white">
                                <div className="flex justify-center relative">
                                    <Icon name="trophy" size={140} className="text-yellow-400 animate-yellow-pulse" />
                                    <div className="absolute -top-4 -right-4 text-6xl animate-ping">‚ú®</div>
                                </div>
                                <h2 className="text-5xl font-black text-blue-600">„ÇÑ„Å£„Åü„Å≠ÔºÅ</h2>
                                <div className="bg-yellow-100 p-8 rounded-[2.5rem] border-4 border-yellow-200">
                                    <p className="text-7xl font-black text-pink-500">{score} / 5</p>
                                    <p className="text-2xl font-bold text-gray-600 mt-2">„Åú„Çì„Å∂ „Åß„Åç„Åü„ÇàÔºÅ</p>
                                </div>
                                <button onClick={() => setCurrentStep('start')} className="bg-sky-500 hover:bg-sky-600 text-white text-3xl font-black py-6 px-12 rounded-full shadow-[0_8px_0_rgb(3,105,161)] transition-all flex items-center gap-4 mx-auto">
                                    „ÇÇ„ÅÜ„ÅÑ„Å°„Å© <Icon name="refresh-ccw" size={32} />
                                </button>
                            </div>
                        )}
                    </div>
                    <div className="mt-8 flex items-center gap-4 bg-white bg-opacity-50 px-6 py-2 rounded-full shadow-sm">
                        <Icon name="volume-2" className="text-blue-500" />
                        <span className="font-bold text-blue-600">„Åä„Å®„Åå „Å™„Çã„ÇàÔºÅ</span>
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
